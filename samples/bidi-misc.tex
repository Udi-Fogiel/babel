%$PDFLaTeX  -*- coding: utf-8 ; mode: latex; TeX-engine: default; -*- 
\documentclass[a4paper]{book}

\usepackage[english,
            bidi=\ifx\XeTeXinputencoding\undefined
              \ifx\directlua\undefined
                default\else
                basic\fi
              \else default\fi,
            layout=sectioning.lists.columns.contents.counters]
           {babel}

\newcommand\provide[1]{\babelprovide[captions=#1,
main                           % comment this line out for a L document
]{hebrew}}

\ifx\XeTeXinputencoding\undefined
  \ifx\directlua\undefined
    \provide{da, script=Hebrew}
    \newcommand\engine{pdftex}
    \usepackage[T1]{fontenc}
  \else
    \usepackage{hyperref}      % doesn't work with pdftex/xetex yet
    \provide{he}
    \newcommand\engine{luatex}
    \babelfont{rm}{Arial}
  \fi
\else
  \provide{he}
  \newcommand\engine{xetex}
  \babelfont{rm}{Arial}
\fi

\begin{document}

\tableofcontents

\listoffigures

\selectlanguage{english}

\chapter{Intro}

This sample is for experiments. It's not a \textit{real} document.

Babel attempts to cover 4 engines (traditional \TeX, pdftex, xetex
and luatex), and 3 formats (Plain, \LaTeX 2e and \LaTeX
2.09). Furthermore, there are L documents with R text, R documents
with L text, and so on.

This document can be typeset with pdftex, xetex and luatex without
changes. The results will be different, and at some points even
wrong. I hope a more or less complete basic bidi support for luatex
(including footnotes, tables, etc.) will be finisehd before Summer
2018. Other engines must wait very likely until Winter.

Note in particular the differences in Latin text in R contexts. Luatex
sets Latin text in L mode, even if the current language and its pardir
is R, so that the first word is at the left, not at the right after the
indent (this is the expected behaviour). pdftex, on the other hand,
sets the text in R mode. With xetex there is an odd mixture of modes —
words in L mode are set in turn in R mode.

In pdftex, the Hebrew captions are replaced by Danish ones. Change it
if you have installed some 8-bit Hebrew font.

The sample PDFs in GitHub has been typeset with version 3.16.1150
(available here).

\chapter{English \engine}

\setcounter{section}{25}
\setcounter{table}{34}
\setcounter{page}{56}

\bigskip
\hrule
\bigskip

\section{Lorem ipsum dolor sit amet}
\label{bla}

\subsection{Praesent risus leo, dictum in vehicula sit amet, feugiat
tempus tellus}

\begin{itemize}
\item First second third fourth fifth sixth seventh eighth.

First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenth fourteenth
  \begin{itemize}
  \item First second third fourth fifth sixth seventh

\begin{verbatim}
First second third fourth fifth sixth seventh eighth
ninth tenth eleventh
twelfth thirteenth fourteenth fifteenth
\end{verbatim}

\begin{trivlist}\item
First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenth fourteenth fifteenth
\end{trivlist}

\begin{quote}
First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenthfourteenth fifteenth

First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenth fourteenth
\end{quote}

\begin{quotation}
First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenthfourteenth fifteenth

First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenth fourteenth
\end{quotation}

\begin{list}{}{\leftmargin1cm \rightmargin2cm }\item
First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenth 

First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth
\end{list}
\end{itemize}
\end{itemize}

\hrule

\newpage

\subsection{Maecenas consectetur vestibulum felis, eu placerat elit
luctus in}

Section: \thesection. Table: \thetable.

\bigskip

\marginpar{First second third fourth fifth sixth}
abc \foreignlanguage{hebrew}{ABC \babelsublr{123} EFG} def
\babelsublr{567} ghi \foreignlanguage{hebrew}{HIJ \ref{bla} KLM}. 

\bigskip

{\raggedright First second third fourth fifth sixth seventh eighth
ninth tenth eleventh twelfth thirteenthfourteenth fifteenth. First
second third fourth fifth sixth seventh eighth ninth tenth eleventh
twelfth thirteenthfourteenth fifteenth.\par}

\bigskip

{\raggedleft First second third fourth fifth sixth seventh eighth
ninth tenth eleventh twelfth thirteenthfourteenth fifteenth. First
second third fourth fifth sixth seventh eighth ninth tenth eleventh
twelfth thirteenthfourteenth fifteenth.\par}

\newpage

\selectlanguage{hebrew}

\chapter{Hebrew}

\hrule

\bigskip

\section{Lorem ipsum dolor sit amet}
\label{bla}

\subsection{Praesent risus leo, dictum in vehicula sit amet, feugiat
tempus tellus}

\begin{itemize}
\item First second third fourth fifth sixth seventh eighth.

First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenth fourteenth
  \begin{itemize}
  \item First second third fourth fifth sixth seventh

\begin{verbatim}
First second third fourth fifth sixth seventh eighth
ninth tenth eleventh
twelfth thirteenth fourteenth fifteenth
\end{verbatim}

\begin{trivlist}\item
First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenth fourteenth fifteenth
\end{trivlist}

\begin{quote}
First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenthfourteenth fifteenth

First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenth fourteenth
\end{quote}

\begin{quotation}
First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenthfourteenth fifteenth

First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenth fourteenth
\end{quotation}

\begin{list}{}{\leftmargin1cm \rightmargin2cm }\item
First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth thirteenth 

First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth
\end{list}
\end{itemize}
\end{itemize}

\hrule

\newpage

\subsection{Nullam suscipit laoreet sollicitudin}

\begin{enumerate}
\setcounter{enumi}{45}
\item First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth.

\item First second third fourth fifth sixth seventh eighth ninth tenth
eleventh.

  \begin{enumerate}
\item First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth.

\item First second third fourth fifth sixth seventh eighth ninth tenth
eleventh.

    \begin{enumerate}
\item First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth.

\item First second third fourth fifth sixth seventh eighth ninth tenth
  eleventh.
    \end{enumerate}
  \end{enumerate}

\item First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth.

    \begin{enumerate}
\item First second third fourth fifth sixth seventh eighth ninth tenth
eleventh twelfth.

  \end{enumerate}
\end{enumerate}

\newpage

\subsection{Maecenas consectetur vestibulum felis, eu placerat elit luctus in}

Section: \thesection. Table: \thetable.

\bigskip

\marginpar{First second third fourth fifth sixth}
abc \foreignlanguage{hebrew}{ABC \babelsublr{123} EFG} def
\babelsublr{567} ghi \foreignlanguage{hebrew}{HIJ \ref{bla} KLM}. 

\bigskip

{\raggedright First second third fourth fifth sixth seventh eighth
ninth tenth eleventh twelfth thirteenthfourteenth fifteenth. First
second third fourth fifth sixth seventh eighth ninth tenth eleventh
twelfth thirteenthfourteenth fifteenth.\par}

\bigskip

{\raggedleft First second third fourth fifth sixth seventh eighth
ninth tenth eleventh twelfth thirteenthfourteenth fifteenth. First
second third fourth fifth sixth seventh eighth ninth tenth eleventh
twelfth thirteenthfourteenth fifteenth.\par}

\bigskip

\ifx\XeTeXinputencoding\undefined
  \ifx\directlua\undefined
  \else
אבגדה HIJ \ref{bla} KLM \thetable{} (OPQ) \TeX{} RST וזחטי.
  \fi
\else
אבגדה HIJ \ref{bla} KLM \thetable{} (OPQ) \TeX{} RST וזחטי.
\fi

ABC \babelsublr{26}.\babelsublr{1} DEF

\begin{figure}
\centering
\framebox{BLA}
\caption{Ut ultricies, dui eget consequat lobortis, dolor eros tempor
diam, quis viverra dolor tortor ac lorem.}
\end{figure}

\begin{figure}
\centering
\framebox{BLA}
\caption{Phasellus ac lacus vel risus faucibus.}
\end{figure}

\twocolumn[%
  \section{Ut suscipit, velit at mattis tempor, arcu justo
                    malesuada sem}%
]

Abla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble
bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli blo

Bblu bla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla
ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli
blo blu bla ble bli blo blu

Cbla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble
bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli blo

DBblu bla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla
ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli
blo blu bla ble bli blo blu

Ebla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble
bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli blo

Fblu bla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla
ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli
blo blu bla ble bli blo blu

Gbla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble
bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli blo

HBblu bla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla
ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli
blo blu bla ble bli blo blu

Ibla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble
bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli blo

Jblu bla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla
ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli
blo blu bla ble bli blo blu

Kbla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble
bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli blo

Lblu bla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla
ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli
blo blu bla ble bli blo blu

Mbla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble
bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli blo

Nblu bla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla
ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli
blo blu bla ble bli blo blu

OCbla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble
bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli blo

Pblu bla ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla
ble bli blo blu bla ble bli blo blu bla ble bli blo blu bla ble bli
blo blu bla ble bli blo blu

\end{document}
